{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\PC\\\\freelance-marketplace\\\\client\\\\src\\\\components\\\\RealTimeChat.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useAuth } from '../context/AuthContext';\nimport socketService from '../services/socketService';\nimport messageService from '../services/messageService';\nimport './RealTimeChat.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst RealTimeChat = ({\n  otherUser,\n  onClose\n}) => {\n  _s();\n  const {\n    user,\n    token\n  } = useAuth();\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [isTyping, setIsTyping] = useState(false);\n  const [otherUserTyping, setOtherUserTyping] = useState(false);\n  const [connectionStatus, setConnectionStatus] = useState('disconnected');\n  const [sending, setSending] = useState(false);\n  const messagesEndRef = useRef(null);\n  const typingTimeoutRef = useRef(null);\n\n  // Auto scroll to bottom\n  const scrollToBottom = () => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: 'smooth'\n    });\n  };\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  // Initialize socket connection and load messages\n  useEffect(() => {\n    if (!user || !otherUser || !token) return;\n    console.log('🚀 Initializing real-time chat...');\n    console.log('Current user:', user.name);\n    console.log('Other user:', otherUser.name);\n\n    // Connect to socket\n    try {\n      socketService.connect(token);\n\n      // Join conversation room\n      socketService.joinConversation(otherUser._id);\n\n      // Load existing messages\n      loadMessages();\n\n      // Setup event listeners\n      setupSocketListeners();\n    } catch (error) {\n      console.error('❌ Failed to initialize chat:', error);\n      setConnectionStatus('error');\n    }\n    return () => {\n      // Cleanup\n      socketService.leaveConversation(otherUser._id);\n      cleanupSocketListeners();\n    };\n  }, [user, otherUser, token]);\n\n  // Load existing messages\n  const loadMessages = async () => {\n    try {\n      console.log('📥 Loading existing messages...');\n      const result = await messageService.getConversationMessages(otherUser._id);\n      if (result.success) {\n        var _result$data;\n        console.log('✅ Messages loaded:', ((_result$data = result.data) === null || _result$data === void 0 ? void 0 : _result$data.length) || 0);\n        // Filter out any undefined or malformed messages\n        const validMessages = (result.data || []).filter(msg => msg && (msg._id || msg.messageId) && msg.content);\n        setMessages(validMessages);\n      } else {\n        console.error('❌ Failed to load messages:', result.error);\n        setMessages([]);\n      }\n    } catch (error) {\n      console.error('❌ Error loading messages:', error);\n      setMessages([]);\n    }\n  };\n\n  // Setup socket event listeners\n  const setupSocketListeners = () => {\n    // Connection status\n    socketService.on('connected', () => {\n      console.log('✅ Chat connected');\n      setConnectionStatus('connected');\n    });\n    socketService.on('disconnected', () => {\n      console.log('🔴 Chat disconnected');\n      setConnectionStatus('disconnected');\n    });\n    socketService.on('connect_error', () => {\n      console.log('❌ Chat connection error');\n      setConnectionStatus('error');\n    });\n\n    // New messages\n    socketService.on('new-message', data => {\n      console.log('📨 Received new message:', data);\n      if (data.success && data.message) {\n        setMessages(prev => {\n          // Check if message already exists to avoid duplicates\n          const messageId = data.message._id || data.message.messageId;\n          if (!messageId) {\n            console.warn('⚠️ Received message without ID:', data.message);\n            return prev;\n          }\n          const exists = prev.some(msg => msg && (msg._id === messageId || msg.messageId === messageId));\n          if (exists) return prev;\n          return [...prev, data.message];\n        });\n      }\n    });\n\n    // Typing indicators\n    socketService.on('user-typing', data => {\n      if (data.userId === otherUser._id) {\n        console.log('⌨️ Other user is typing');\n        setOtherUserTyping(true);\n      }\n    });\n    socketService.on('user-stop-typing', data => {\n      if (data.userId === otherUser._id) {\n        console.log('⌨️ Other user stopped typing');\n        setOtherUserTyping(false);\n      }\n    });\n\n    // Message read receipts\n    socketService.on('message-read', data => {\n      console.log('✅ Message read receipt:', data);\n      setMessages(prev => prev.map(msg => msg._id === data.messageId ? {\n        ...msg,\n        status: 'read',\n        readAt: data.readAt\n      } : msg));\n    });\n  };\n\n  // Cleanup socket listeners\n  const cleanupSocketListeners = () => {\n    socketService.off('connected');\n    socketService.off('disconnected');\n    socketService.off('connect_error');\n    socketService.off('new-message');\n    socketService.off('user-typing');\n    socketService.off('user-stop-typing');\n    socketService.off('message-read');\n  };\n\n  // Handle sending messages\n  const handleSendMessage = async e => {\n    e.preventDefault();\n    if (!newMessage.trim() || sending) return;\n    const messageContent = newMessage.trim();\n    setNewMessage('');\n    setSending(true);\n    try {\n      console.log('📤 Sending message via Socket.io...');\n\n      // Send via socket for real-time delivery\n      if (socketService.isConnected()) {\n        await socketService.sendMessage(otherUser._id, messageContent);\n        console.log('✅ Message sent via Socket.io');\n      } else {\n        // Fallback to HTTP API\n        console.log('📡 Socket not connected, using HTTP API...');\n        const result = await messageService.sendMessage(otherUser._id, messageContent);\n        if (result.success) {\n          setMessages(prev => [...prev, result.data]);\n        } else {\n          throw new Error(result.error);\n        }\n      }\n\n      // Stop typing\n      socketService.stopTyping(otherUser._id);\n      setIsTyping(false);\n    } catch (error) {\n      console.error('❌ Failed to send message:', error);\n      // Restore message on error\n      setNewMessage(messageContent);\n      alert('Failed to send message. Please try again.');\n    } finally {\n      setSending(false);\n    }\n  };\n\n  // Handle typing indicators\n  const handleTyping = e => {\n    setNewMessage(e.target.value);\n    if (!isTyping && e.target.value.trim()) {\n      setIsTyping(true);\n      socketService.startTyping(otherUser._id);\n    }\n\n    // Clear existing timeout\n    if (typingTimeoutRef.current) {\n      clearTimeout(typingTimeoutRef.current);\n    }\n\n    // Set new timeout\n    typingTimeoutRef.current = setTimeout(() => {\n      if (isTyping) {\n        setIsTyping(false);\n        socketService.stopTyping(otherUser._id);\n      }\n    }, 2000);\n  };\n\n  // Format message time\n  const formatTime = dateString => {\n    const date = new Date(dateString);\n    return date.toLocaleTimeString([], {\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  // Get connection status display\n  const getConnectionStatusDisplay = () => {\n    switch (connectionStatus) {\n      case 'connected':\n        return /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"status-connected\",\n          children: \"\\uD83D\\uDFE2 Real-time\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 16\n        }, this);\n      case 'disconnected':\n        return /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"status-disconnected\",\n          children: \"\\uD83D\\uDD34 Disconnected\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 16\n        }, this);\n      case 'error':\n        return /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"status-error\",\n          children: \"\\u274C Connection Error\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 16\n        }, this);\n      default:\n        return /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"status-connecting\",\n          children: \"\\uD83D\\uDFE1 Connecting...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 16\n        }, this);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"realtime-chat\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"user-info\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: otherUser.avatar || '/default-avatar.png',\n          alt: otherUser.name,\n          className: \"user-avatar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: otherUser.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 256,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"user-role\",\n            children: otherUser.role\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat-status\",\n        children: getConnectionStatusDisplay()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"close-btn\",\n        onClick: onClose,\n        children: \"\\u2715\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"messages-container\",\n      children: [messages.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"no-messages\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Start your conversation with \", otherUser.name]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 269,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 11\n      }, this) : messages.filter(message => message && (message._id || message.messageId)).map(message => {\n        var _message$senderId, _message$sender;\n        // Safe way to get sender ID with null checks\n        const senderId = ((_message$senderId = message.senderId) === null || _message$senderId === void 0 ? void 0 : _message$senderId._id) || message.senderId || ((_message$sender = message.sender) === null || _message$sender === void 0 ? void 0 : _message$sender._id) || message.sender;\n        const isSentByMe = senderId === user.id || senderId === user._id;\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `message ${isSentByMe ? 'sent' : 'received'}`,\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"message-content\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: message.content || 'Message content unavailable'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 283,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"message-meta\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"message-time\",\n                children: formatTime(message.createdAt || message.timestamp)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 285,\n                columnNumber: 21\n              }, this), isSentByMe ? /*#__PURE__*/_jsxDEV(\"span\", {\n                className: `message-status ${message.status || 'sent'}`,\n                children: message.status === 'read' ? '✓✓' : '✓'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 287,\n                columnNumber: 23\n              }, this) : null]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 284,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 282,\n            columnNumber: 17\n          }, this)\n        }, message._id || message.messageId || Math.random(), false, {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 15\n        }, this);\n      }), otherUserTyping && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"typing-indicator\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"typing-dots\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 301,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 303,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [otherUser.name, \" is typing...\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 299,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: messagesEndRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"message-form\",\n      onSubmit: handleSendMessage,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"input-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          value: newMessage,\n          onChange: handleTyping,\n          placeholder: \"Type your message...\",\n          disabled: sending,\n          className: \"message-input\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 314,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          disabled: !newMessage.trim() || sending,\n          className: \"send-btn\",\n          children: sending ? '⏳' : '📤'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 322,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 313,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 312,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 247,\n    columnNumber: 5\n  }, this);\n};\n_s(RealTimeChat, \"ugUO0sHd7QGys9BLJGkfbzOc3Mc=\", false, function () {\n  return [useAuth];\n});\n_c = RealTimeChat;\nexport default RealTimeChat;\nvar _c;\n$RefreshReg$(_c, \"RealTimeChat\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useAuth","socketService","messageService","jsxDEV","_jsxDEV","RealTimeChat","otherUser","onClose","_s","user","token","messages","setMessages","newMessage","setNewMessage","isTyping","setIsTyping","otherUserTyping","setOtherUserTyping","connectionStatus","setConnectionStatus","sending","setSending","messagesEndRef","typingTimeoutRef","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","console","log","name","connect","joinConversation","_id","loadMessages","setupSocketListeners","error","leaveConversation","cleanupSocketListeners","result","getConversationMessages","success","_result$data","data","length","validMessages","filter","msg","messageId","content","on","message","prev","warn","exists","some","userId","map","status","readAt","off","handleSendMessage","e","preventDefault","trim","messageContent","isConnected","sendMessage","Error","stopTyping","alert","handleTyping","target","value","startTyping","clearTimeout","setTimeout","formatTime","dateString","date","Date","toLocaleTimeString","hour","minute","getConnectionStatusDisplay","className","children","fileName","_jsxFileName","lineNumber","columnNumber","src","avatar","alt","role","onClick","_message$senderId","_message$sender","senderId","sender","isSentByMe","id","createdAt","timestamp","Math","random","ref","onSubmit","type","onChange","placeholder","disabled","_c","$RefreshReg$"],"sources":["C:/Users/PC/freelance-marketplace/client/src/components/RealTimeChat.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport socketService from '../services/socketService';\r\nimport messageService from '../services/messageService';\r\nimport './RealTimeChat.css';\r\n\r\nconst RealTimeChat = ({ otherUser, onClose }) => {\r\n  const { user, token } = useAuth();\r\n  const [messages, setMessages] = useState([]);\r\n  const [newMessage, setNewMessage] = useState('');\r\n  const [isTyping, setIsTyping] = useState(false);\r\n  const [otherUserTyping, setOtherUserTyping] = useState(false);\r\n  const [connectionStatus, setConnectionStatus] = useState('disconnected');\r\n  const [sending, setSending] = useState(false);\r\n  const messagesEndRef = useRef(null);\r\n  const typingTimeoutRef = useRef(null);\r\n\r\n  // Auto scroll to bottom\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  };\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [messages]);\r\n\r\n  // Initialize socket connection and load messages\r\n  useEffect(() => {\r\n    if (!user || !otherUser || !token) return;\r\n\r\n    console.log('🚀 Initializing real-time chat...');\r\n    console.log('Current user:', user.name);\r\n    console.log('Other user:', otherUser.name);\r\n\r\n    // Connect to socket\r\n    try {\r\n      socketService.connect(token);\r\n      \r\n      // Join conversation room\r\n      socketService.joinConversation(otherUser._id);\r\n\r\n      // Load existing messages\r\n      loadMessages();\r\n\r\n      // Setup event listeners\r\n      setupSocketListeners();\r\n\r\n    } catch (error) {\r\n      console.error('❌ Failed to initialize chat:', error);\r\n      setConnectionStatus('error');\r\n    }\r\n\r\n    return () => {\r\n      // Cleanup\r\n      socketService.leaveConversation(otherUser._id);\r\n      cleanupSocketListeners();\r\n    };\r\n  }, [user, otherUser, token]);\r\n\r\n  // Load existing messages\r\n  const loadMessages = async () => {\r\n    try {\r\n      console.log('📥 Loading existing messages...');\r\n      const result = await messageService.getConversationMessages(otherUser._id);\r\n      \r\n      if (result.success) {\r\n        console.log('✅ Messages loaded:', result.data?.length || 0);\r\n        // Filter out any undefined or malformed messages\r\n        const validMessages = (result.data || []).filter(msg => \r\n          msg && (msg._id || msg.messageId) && msg.content\r\n        );\r\n        setMessages(validMessages);\r\n      } else {\r\n        console.error('❌ Failed to load messages:', result.error);\r\n        setMessages([]);\r\n      }\r\n    } catch (error) {\r\n      console.error('❌ Error loading messages:', error);\r\n      setMessages([]);\r\n    }\r\n  };\r\n\r\n  // Setup socket event listeners\r\n  const setupSocketListeners = () => {\r\n    // Connection status\r\n    socketService.on('connected', () => {\r\n      console.log('✅ Chat connected');\r\n      setConnectionStatus('connected');\r\n    });\r\n\r\n    socketService.on('disconnected', () => {\r\n      console.log('🔴 Chat disconnected');\r\n      setConnectionStatus('disconnected');\r\n    });\r\n\r\n    socketService.on('connect_error', () => {\r\n      console.log('❌ Chat connection error');\r\n      setConnectionStatus('error');\r\n    });\r\n\r\n    // New messages\r\n    socketService.on('new-message', (data) => {\r\n      console.log('📨 Received new message:', data);\r\n      if (data.success && data.message) {\r\n        setMessages(prev => {\r\n          // Check if message already exists to avoid duplicates\r\n          const messageId = data.message._id || data.message.messageId;\r\n          if (!messageId) {\r\n            console.warn('⚠️ Received message without ID:', data.message);\r\n            return prev;\r\n          }\r\n          \r\n          const exists = prev.some(msg => \r\n            msg && (msg._id === messageId || msg.messageId === messageId)\r\n          );\r\n          if (exists) return prev;\r\n          \r\n          return [...prev, data.message];\r\n        });\r\n      }\r\n    });\r\n\r\n    // Typing indicators\r\n    socketService.on('user-typing', (data) => {\r\n      if (data.userId === otherUser._id) {\r\n        console.log('⌨️ Other user is typing');\r\n        setOtherUserTyping(true);\r\n      }\r\n    });\r\n\r\n    socketService.on('user-stop-typing', (data) => {\r\n      if (data.userId === otherUser._id) {\r\n        console.log('⌨️ Other user stopped typing');\r\n        setOtherUserTyping(false);\r\n      }\r\n    });\r\n\r\n    // Message read receipts\r\n    socketService.on('message-read', (data) => {\r\n      console.log('✅ Message read receipt:', data);\r\n      setMessages(prev => prev.map(msg => \r\n        msg._id === data.messageId \r\n          ? { ...msg, status: 'read', readAt: data.readAt }\r\n          : msg\r\n      ));\r\n    });\r\n  };\r\n\r\n  // Cleanup socket listeners\r\n  const cleanupSocketListeners = () => {\r\n    socketService.off('connected');\r\n    socketService.off('disconnected');\r\n    socketService.off('connect_error');\r\n    socketService.off('new-message');\r\n    socketService.off('user-typing');\r\n    socketService.off('user-stop-typing');\r\n    socketService.off('message-read');\r\n  };\r\n\r\n  // Handle sending messages\r\n  const handleSendMessage = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    if (!newMessage.trim() || sending) return;\r\n\r\n    const messageContent = newMessage.trim();\r\n    setNewMessage('');\r\n    setSending(true);\r\n\r\n    try {\r\n      console.log('📤 Sending message via Socket.io...');\r\n      \r\n      // Send via socket for real-time delivery\r\n      if (socketService.isConnected()) {\r\n        await socketService.sendMessage(otherUser._id, messageContent);\r\n        console.log('✅ Message sent via Socket.io');\r\n      } else {\r\n        // Fallback to HTTP API\r\n        console.log('📡 Socket not connected, using HTTP API...');\r\n        const result = await messageService.sendMessage(otherUser._id, messageContent);\r\n        \r\n        if (result.success) {\r\n          setMessages(prev => [...prev, result.data]);\r\n        } else {\r\n          throw new Error(result.error);\r\n        }\r\n      }\r\n\r\n      // Stop typing\r\n      socketService.stopTyping(otherUser._id);\r\n      setIsTyping(false);\r\n\r\n    } catch (error) {\r\n      console.error('❌ Failed to send message:', error);\r\n      // Restore message on error\r\n      setNewMessage(messageContent);\r\n      alert('Failed to send message. Please try again.');\r\n    } finally {\r\n      setSending(false);\r\n    }\r\n  };\r\n\r\n  // Handle typing indicators\r\n  const handleTyping = (e) => {\r\n    setNewMessage(e.target.value);\r\n\r\n    if (!isTyping && e.target.value.trim()) {\r\n      setIsTyping(true);\r\n      socketService.startTyping(otherUser._id);\r\n    }\r\n\r\n    // Clear existing timeout\r\n    if (typingTimeoutRef.current) {\r\n      clearTimeout(typingTimeoutRef.current);\r\n    }\r\n\r\n    // Set new timeout\r\n    typingTimeoutRef.current = setTimeout(() => {\r\n      if (isTyping) {\r\n        setIsTyping(false);\r\n        socketService.stopTyping(otherUser._id);\r\n      }\r\n    }, 2000);\r\n  };\r\n\r\n  // Format message time\r\n  const formatTime = (dateString) => {\r\n    const date = new Date(dateString);\r\n    return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\r\n  };\r\n\r\n  // Get connection status display\r\n  const getConnectionStatusDisplay = () => {\r\n    switch (connectionStatus) {\r\n      case 'connected':\r\n        return <span className=\"status-connected\">🟢 Real-time</span>;\r\n      case 'disconnected':\r\n        return <span className=\"status-disconnected\">🔴 Disconnected</span>;\r\n      case 'error':\r\n        return <span className=\"status-error\">❌ Connection Error</span>;\r\n      default:\r\n        return <span className=\"status-connecting\">🟡 Connecting...</span>;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"realtime-chat\">\r\n      <div className=\"chat-header\">\r\n        <div className=\"user-info\">\r\n          <img \r\n            src={otherUser.avatar || '/default-avatar.png'} \r\n            alt={otherUser.name}\r\n            className=\"user-avatar\"\r\n          />\r\n          <div>\r\n            <h3>{otherUser.name}</h3>\r\n            <span className=\"user-role\">{otherUser.role}</span>\r\n          </div>\r\n        </div>\r\n        <div className=\"chat-status\">\r\n          {getConnectionStatusDisplay()}\r\n        </div>\r\n        <button className=\"close-btn\" onClick={onClose}>✕</button>\r\n      </div>\r\n\r\n      <div className=\"messages-container\">\r\n        {messages.length === 0 ? (\r\n          <div className=\"no-messages\">\r\n            <p>Start your conversation with {otherUser.name}</p>\r\n          </div>\r\n        ) : (\r\n          messages.filter(message => message && (message._id || message.messageId)).map((message) => {\r\n            // Safe way to get sender ID with null checks\r\n            const senderId = message.senderId?._id || message.senderId || message.sender?._id || message.sender;\r\n            const isSentByMe = senderId === user.id || senderId === user._id;\r\n            \r\n            return (\r\n              <div\r\n                key={message._id || message.messageId || Math.random()}\r\n                className={`message ${isSentByMe ? 'sent' : 'received'}`}\r\n              >\r\n                <div className=\"message-content\">\r\n                  <p>{message.content || 'Message content unavailable'}</p>\r\n                  <div className=\"message-meta\">\r\n                    <span className=\"message-time\">{formatTime(message.createdAt || message.timestamp)}</span>\r\n                    {isSentByMe ? (\r\n                      <span className={`message-status ${message.status || 'sent'}`}>\r\n                        {message.status === 'read' ? '✓✓' : '✓'}\r\n                      </span>\r\n                    ) : null}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            );\r\n          })\r\n        )}\r\n        \r\n        {otherUserTyping && (\r\n          <div className=\"typing-indicator\">\r\n            <div className=\"typing-dots\">\r\n              <span></span>\r\n              <span></span>\r\n              <span></span>\r\n            </div>\r\n            <p>{otherUser.name} is typing...</p>\r\n          </div>\r\n        )}\r\n        \r\n        <div ref={messagesEndRef} />\r\n      </div>\r\n\r\n      <form className=\"message-form\" onSubmit={handleSendMessage}>\r\n        <div className=\"input-container\">\r\n          <input\r\n            type=\"text\"\r\n            value={newMessage}\r\n            onChange={handleTyping}\r\n            placeholder=\"Type your message...\"\r\n            disabled={sending}\r\n            className=\"message-input\"\r\n          />\r\n          <button \r\n            type=\"submit\" \r\n            disabled={!newMessage.trim() || sending}\r\n            className=\"send-btn\"\r\n          >\r\n            {sending ? '⏳' : '📤'}\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default RealTimeChat;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}