{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link}from'react-router-dom';import{useAuth}from'../context/AuthContext';import orderService from'../services/orderService';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Orders=()=>{const{user}=useAuth();const[orders,setOrders]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[filter,setFilter]=useState('all');const[currentPage,setCurrentPage]=useState(1);const[pagination,setPagination]=useState(null);useEffect(()=>{fetchOrders();},[filter,currentPage]);const fetchOrders=async()=>{setLoading(true);setError(null);const params={page:currentPage,limit:10};if(filter!=='all'){params.status=filter;}const result=await orderService.getOrders(params);if(result.success){setOrders(result.data);setPagination(result.pagination);}else{setError(result.error);}setLoading(false);};const handleStatusUpdate=async(orderId,newStatus)=>{const result=await orderService.updateOrderStatus(orderId,newStatus);if(result.success){// Refresh the orders list\nfetchOrders();}else{setError(result.error);}};const formatDate=dateString=>{return new Date(dateString).toLocaleDateString('en-US',{year:'numeric',month:'short',day:'numeric',hour:'2-digit',minute:'2-digit'});};const formatPrice=price=>{return new Intl.NumberFormat('en-US',{style:'currency',currency:'USD'}).format(price);};const getAvailableActions=order=>{const actions=[];if((user===null||user===void 0?void 0:user.role)==='freelancer'){if(order.status==='paid'){actions.push({label:'Start Work',status:'in_progress',className:'bg-blue-600 hover:bg-blue-700 text-white'});}else if(order.status==='in_progress'){actions.push({label:'Mark Complete',status:'completed',className:'bg-green-600 hover:bg-green-700 text-white'});}if(order.status!=='completed'&&order.status!=='cancelled'){actions.push({label:'Cancel',status:'cancelled',className:'bg-red-600 hover:bg-red-700 text-white'});}}else if((user===null||user===void 0?void 0:user.role)==='client'){if(order.status!=='completed'&&order.status!=='cancelled'){actions.push({label:'Cancel',status:'cancelled',className:'bg-red-600 hover:bg-red-700 text-white'});}}return actions;};if(loading&&orders.length===0){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-50 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-4 text-gray-600\",children:\"Loading orders...\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-50\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white shadow\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\",children:/*#__PURE__*/_jsx(\"div\",{className:\"py-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"md:flex md:items-center md:justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 min-w-0\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl\",children:(user===null||user===void 0?void 0:user.role)==='client'?'My Orders':'My Work'}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-gray-500\",children:(user===null||user===void 0?void 0:user.role)==='client'?'Track your hired services and orders':'Manage your active projects and deliverables'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 flex md:mt-0 md:ml-4\",children:/*#__PURE__*/_jsx(Link,{to:\"/dashboard\",className:\"bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50\",children:\"Back to Dashboard\"})})]})})})}),/*#__PURE__*/_jsx(\"div\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg shadow p-4\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:['all','pending','paid','in_progress','completed','cancelled'].map(status=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setFilter(status);setCurrentPage(1);},className:\"px-4 py-2 rounded-md text-sm font-medium \".concat(filter===status?'bg-blue-600 text-white':'bg-gray-100 text-gray-700 hover:bg-gray-200'),children:status==='all'?'All Orders':orderService.getStatusText(status)},status))})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-8\",children:[error&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 bg-red-50 border border-red-200 rounded-md p-4\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-red-600\",children:error})}),orders.length===0&&!loading?/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow p-8 text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-8 h-8 text-gray-400\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"})})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900 mb-2\",children:\"No Orders Found\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 mb-4\",children:(user===null||user===void 0?void 0:user.role)==='client'?\"You haven't placed any orders yet. Start by browsing available services!\":\"You haven't received any orders yet. Make sure your gigs are visible and attractive!\"}),/*#__PURE__*/_jsx(Link,{to:\"/gigs\",className:\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700\",children:(user===null||user===void 0?void 0:user.role)==='client'?'Browse Services':'View All Gigs'})]}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-4\",children:orders.map(order=>{var _order$gig,_order$freelancer,_order$client;return/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg shadow overflow-hidden\",children:/*#__PURE__*/_jsx(\"div\",{className:\"p-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2 mb-2\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-medium text-gray-900\",children:(_order$gig=order.gig)===null||_order$gig===void 0?void 0:_order$gig.title}),/*#__PURE__*/_jsx(\"span\",{className:\"px-2 py-1 rounded-full text-xs font-medium \".concat(orderService.getStatusColor(order.status)),children:orderService.getStatusText(order.status)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm text-gray-600\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Order ID:\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-mono\",children:order.orderId})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:(user===null||user===void 0?void 0:user.role)==='client'?'Freelancer:':'Client:'}),/*#__PURE__*/_jsx(\"p\",{children:(user===null||user===void 0?void 0:user.role)==='client'?(_order$freelancer=order.freelancer)===null||_order$freelancer===void 0?void 0:_order$freelancer.name:(_order$client=order.client)===null||_order$client===void 0?void 0:_order$client.name})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Amount:\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-lg font-semibold text-green-600\",children:formatPrice(order.amount)})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Created:\"}),/*#__PURE__*/_jsx(\"p\",{children:formatDate(order.createdAt)})]})]}),order.deliveryDate&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 text-sm text-gray-600\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Expected Delivery:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2\",children:formatDate(order.deliveryDate)})]}),order.requirements&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm font-medium text-gray-700\",children:\"Requirements:\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600 mt-1\",children:order.requirements})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-6 flex flex-col space-y-2\",children:[getAvailableActions(order).map((action,index)=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleStatusUpdate(order._id,action.status),className:\"px-4 py-2 rounded-md text-sm font-medium \".concat(action.className),children:action.label},index)),/*#__PURE__*/_jsx(Link,{to:\"/orders/\".concat(order._id),className:\"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 text-center\",children:\"View Details\"})]})]})})},order._id);})}),pagination&&pagination.pages>1&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-gray-700\",children:[\"Showing \",(pagination.page-1)*pagination.limit+1,\" to\",' ',Math.min(pagination.page*pagination.limit,pagination.total),\" of\",' ',pagination.total,\" results\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentPage(prev=>Math.max(prev-1,1)),disabled:pagination.page===1,className:\"px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\",children:\"Previous\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"px-3 py-2 text-sm text-gray-700\",children:[\"Page \",pagination.page,\" of \",pagination.pages]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentPage(prev=>Math.min(prev+1,pagination.pages)),disabled:pagination.page===pagination.pages,className:\"px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed\",children:\"Next\"})]})]})]})]});};export default Orders;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}