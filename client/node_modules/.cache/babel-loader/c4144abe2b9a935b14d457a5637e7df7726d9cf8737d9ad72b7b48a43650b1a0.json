{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useParams,Link,useNavigate}from'react-router-dom';import{useGigs}from'../context/GigContext';import{useAuth}from'../context/AuthContext';import{getImageUrl}from'../utils/imageUtils';import orderService from'../services/orderService';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const GigDetails=()=>{var _currentGig$seller2,_currentGig$seller2$n,_currentGig$seller2$n2,_currentGig$seller3,_currentGig$seller4;const{id}=useParams();const{currentGig,loading,error,getGig}=useGigs();const{user,isAuthenticated}=useAuth();const navigate=useNavigate();const[selectedImage,setSelectedImage]=useState(0);const[showPurchaseModal,setShowPurchaseModal]=useState(false);const[purchaseLoading,setPurchaseLoading]=useState(false);const[requirements,setRequirements]=useState('');useEffect(()=>{if(id){getGig(id);}},[id,getGig]);// Handle purchase action\nconst handlePurchase=()=>{if(!isAuthenticated){navigate('/login');return;}if((user===null||user===void 0?void 0:user.role)!=='client'){alert('Only clients can purchase gigs. Please register as a client.');return;}setShowPurchaseModal(true);};// Confirm purchase\nconst confirmPurchase=async()=>{setPurchaseLoading(true);try{// Create order directly using our order service\nconst response=await orderService.createOrder(currentGig._id,requirements);if(response.success){// Close modal\nsetShowPurchaseModal(false);// Show success message\nalert('Order created successfully! You can track its progress in your dashboard.');// Navigate to orders page\nnavigate('/orders');}else{throw new Error(response.error||'Failed to create order');}}catch(error){console.error('Purchase error:',error);alert(\"Order creation failed: \".concat(error.message));}finally{setPurchaseLoading(false);}};// Contact seller\nconst handleContact=()=>{var _currentGig$seller;if(!isAuthenticated){navigate('/login');return;}// For now, just show an alert. Later you can implement messaging system\nalert(\"Contact feature coming soon! For now, you can reach out to \".concat((_currentGig$seller=currentGig.seller)===null||_currentGig$seller===void 0?void 0:_currentGig$seller.name,\" directly.\"));};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-50 flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-xl\",children:\"Loading gig details...\"})});}if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-50 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-900 mb-4\",children:\"Error\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-red-600 mb-4\",children:error}),/*#__PURE__*/_jsx(Link,{to:\"/gigs\",className:\"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded\",children:\"Back to Gigs\"})]})});}if(!currentGig){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen bg-gray-50 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-900 mb-4\",children:\"Gig Not Found\"}),/*#__PURE__*/_jsx(Link,{to:\"/gigs\",className:\"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded\",children:\"Back to Gigs\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-50\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"max-w-7xl mx-auto py-6 sm:px-6 lg:px-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"px-4 py-6 sm:px-0\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsx(\"nav\",{className:\"flex\",\"aria-label\":\"Breadcrumb\",children:/*#__PURE__*/_jsxs(\"ol\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/\",className:\"text-gray-400 hover:text-gray-500\",children:\"Home\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"flex-shrink-0 h-5 w-5 text-gray-300\",fill:\"currentColor\",viewBox:\"0 0 20 20\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z\",clipRule:\"evenodd\"})}),/*#__PURE__*/_jsx(Link,{to:\"/gigs\",className:\"ml-4 text-gray-400 hover:text-gray-500\",children:\"All Gigs\"})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"flex-shrink-0 h-5 w-5 text-gray-300\",fill:\"currentColor\",viewBox:\"0 0 20 20\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z\",clipRule:\"evenodd\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-4 text-gray-500 truncate\",children:currentGig===null||currentGig===void 0?void 0:currentGig.title})]})})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-3 gap-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lg:col-span-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-lg shadow-sm overflow-hidden mb-8\",children:currentGig.images&&currentGig.images.length>0?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"w-full h-96 object-cover\",src:getImageUrl(currentGig.images[selectedImage]),alt:currentGig.title}),currentGig.images.length>1&&/*#__PURE__*/_jsxs(\"div\",{className:\"absolute bottom-4 right-4 bg-black bg-opacity-50 text-white px-2 py-1 rounded text-sm\",children:[selectedImage+1,\" / \",currentGig.images.length]})]}),currentGig.images.length>1&&/*#__PURE__*/_jsx(\"div\",{className:\"p-4 bg-gray-50 border-t\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex space-x-2 overflow-x-auto\",children:currentGig.images.map((image,index)=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>setSelectedImage(index),className:\"flex-shrink-0 w-20 h-20 rounded-lg overflow-hidden border-2 transition-colors \".concat(selectedImage===index?'border-blue-500':'border-gray-200 hover:border-gray-300'),children:/*#__PURE__*/_jsx(\"img\",{className:\"w-full h-full object-cover\",src:getImageUrl(image),alt:\"\".concat(currentGig.title,\" \").concat(index+1)})},index))})})]}):/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-96 bg-gray-200 flex items-center justify-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"text-center\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"mx-auto h-12 w-12 text-gray-400\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 text-gray-500\",children:\"No images available\"})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm p-6 mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-900 mb-4\",children:\"About This Gig\"}),/*#__PURE__*/_jsx(\"div\",{className:\"prose max-w-none\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 leading-relaxed whitespace-pre-line\",children:currentGig.description})})]}),currentGig.tags&&currentGig.tags.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-3\",children:\"Skills & Expertise\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:currentGig.tags.map((tag,index)=>/*#__PURE__*/_jsx(\"span\",{className:\"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium\",children:tag},index))})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"lg:col-span-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm p-6 mb-6 sticky top-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"border-b border-gray-200 pb-4 mb-4\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-bold text-gray-900 mb-2 line-clamp-2\",children:currentGig.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"text-3xl font-bold text-green-600\",children:[\"$\",currentGig.price]}),/*#__PURE__*/_jsx(\"span\",{className:\"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-medium\",children:currentGig.category})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Delivery Time:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-medium\",children:[currentGig.deliveryTime,\" days\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Rating:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex text-yellow-400\",children:[...Array(5)].map((_,i)=>/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 fill-current\",viewBox:\"0 0 20 20\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z\"})},i))}),/*#__PURE__*/_jsxs(\"span\",{className:\"ml-1 text-sm text-gray-600\",children:[currentGig.rating||5.0,\" (\",currentGig.numOfReviews||0,\" reviews)\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Orders:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-medium\",children:[currentGig.totalSales||0,\" completed\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[(user===null||user===void 0?void 0:user.role)==='client'||!isAuthenticated?/*#__PURE__*/_jsxs(\"button\",{onClick:handlePurchase,className:\"w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg transition-colors duration-200 flex items-center justify-center\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-5 h-5 mr-2\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.5 1.5M7 13l-1.5-1.5m0 0L4 15m0 0l1.5 1.5M4 15l1.5-1.5\"})}),!isAuthenticated?'Purchase Now':'Hire Freelancer']}):/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-100 text-gray-600 py-3 px-6 rounded-lg text-center\",children:\"Only clients can purchase gigs\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleContact,className:\"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg transition-colors duration-200\",children:\"Contact Seller\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow-sm p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"About the Seller\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start space-x-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-white font-bold text-lg\",children:(_currentGig$seller2=currentGig.seller)===null||_currentGig$seller2===void 0?void 0:(_currentGig$seller2$n=_currentGig$seller2.name)===null||_currentGig$seller2$n===void 0?void 0:(_currentGig$seller2$n2=_currentGig$seller2$n.charAt(0))===null||_currentGig$seller2$n2===void 0?void 0:_currentGig$seller2$n2.toUpperCase()})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-semibold text-gray-900\",children:(_currentGig$seller3=currentGig.seller)===null||_currentGig$seller3===void 0?void 0:_currentGig$seller3.name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 text-sm\",children:(_currentGig$seller4=currentGig.seller)===null||_currentGig$seller4===void 0?void 0:_currentGig$seller4.email}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 flex items-center text-sm text-gray-600\",children:[/*#__PURE__*/_jsx(\"svg\",{className:\"w-4 h-4 mr-1\",fill:\"currentColor\",viewBox:\"0 0 20 20\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z\",clipRule:\"evenodd\"})}),\"Member since 2024\"]})]})]})]})]})]})]})}),showPurchaseModal&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg max-w-md w-full p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold\",children:\"Confirm Purchase\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowPurchaseModal(false),className:\"text-gray-400 hover:text-gray-600\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-6 h-6\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M6 18L18 6M6 6l12 12\"})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-50 rounded-lg p-4 mb-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-gray-900 mb-2\",children:currentGig.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Total:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-2xl font-bold text-green-600\",children:[\"$\",currentGig.price]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mt-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Delivery:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-sm text-gray-600\",children:[currentGig.deliveryTime,\" days\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"requirements\",className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"Project Requirements (Optional)\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"requirements\",value:requirements,onChange:e=>setRequirements(e.target.value),placeholder:\"Describe any specific requirements for your project...\",className:\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\",rows:\"3\",maxLength:\"1000\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:[requirements.length,\"/1000 characters\"]})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"By clicking \\\"Proceed to Payment\\\", you will be redirected to Stripe to complete your purchase securely. The freelancer will be notified once payment is confirmed.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowPurchaseModal(false),className:\"flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-4 rounded-lg transition-colors\",children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{onClick:confirmPurchase,disabled:purchaseLoading,className:\"flex-1 bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center\",children:purchaseLoading?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"svg\",{className:\"animate-spin -ml-1 mr-2 h-4 w-4 text-white\",fill:\"none\",viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsx(\"circle\",{className:\"opacity-25\",cx:\"12\",cy:\"12\",r:\"10\",stroke:\"currentColor\",strokeWidth:\"4\"}),/*#__PURE__*/_jsx(\"path\",{className:\"opacity-75\",fill:\"currentColor\",d:\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"})]}),\"Processing...\"]}):'Proceed to Payment'})]})]})})]});};export default GigDetails;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}